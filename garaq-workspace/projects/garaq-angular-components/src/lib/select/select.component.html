@if (inputLabel()) {
  <label class="gc-label" [id]="_id + '-label'" [for]="_triggerId">{{ inputLabel() }}</label>
}

<button
  type="button"
  class="gc-trigger"
  [id]="_triggerId"
  role="combobox"
  [disabled]="disabled()"
  [attr.aria-expanded]="_isOpen()"
  [attr.aria-controls]="_listboxId"
  [attr.aria-activedescendant]="_activeDescendantId()"
  [attr.aria-labelledby]="inputLabel() ? _id + '-label' : null"
  aria-haspopup="listbox"
  (click)="_toggle()"
  (keydown)="_onKeydown($event)"
>
  <span class="gc-prefix">
    <ng-content select="[gcPrefix]" />
  </span>

  @if (_displayLabel()) {
    <span class="gc-value">{{ _displayLabel() }}</span>
  } @else {
    <span class="gc-placeholder">{{ placeholder() }}</span>
  }

  <span class="gc-chevron" aria-hidden="true">
    <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="4 6 8 10 12 6" />
    </svg>
  </span>
</button>

@if (_isOpen()) {
  <ul
    class="gc-listbox"
    role="listbox"
    [id]="_listboxId"
    [attr.aria-labelledby]="inputLabel() ? _id + '-label' : null"
  >
    @for (opt of _normalizedOptions(); track opt.value; let i = $index) {
      <li
        class="gc-option"
        role="option"
        [id]="_id + '-option-' + i"
        [class.gc-option-highlighted]="i === _highlightedIndex()"
        [class.gc-option-selected]="_selectedValue() === opt.value"
        [class.gc-option-disabled]="opt.disabled"
        [attr.aria-selected]="_selectedValue() === opt.value"
        [attr.aria-disabled]="opt.disabled || null"
        (click)="_selectOption(opt)"
        (mouseenter)="_onOptionMouseenter(i)"
      >
        <span class="gc-option-check">
          @if (_selectedValue() === opt.value) {
            <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="3 8 6.5 11.5 13 5" />
            </svg>
          }
        </span>
        <span class="gc-option-content">
          <span class="gc-option-label">{{ opt.label }}</span>
          @if (opt.description) {
            <span class="gc-option-description">{{ opt.description }}</span>
          }
        </span>
      </li>
    } @empty {
      <li class="gc-empty" role="presentation">{{ emptyText() }}</li>
    }
  </ul>
}

@if (inputDescription()) {
  <p class="gc-description">{{ inputDescription() }}</p>
}
